<!--
    Robert Yantin Jr.
    CEN 3024 - Software Development I
    October 27, 2025
    employees.html
    This HTL file ss he main page of the Employee Directory Management System.
    It displays all employees in a searchable, interactive table where users can
    add, update, or delete employees.  The layout uses Bootstrap for styling and
    JavaScript for selecting rows, highlighting them, and handling actions like
    editing or deleting.  This is basically the front end view that connects with
    our SpringBoot backend.
-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Employee Directory</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<!-- Main JavaScript section -->
<script>
    let selectedId = null; //keeping track of which employee is clicked

    //Function runs whenever a table row (employee) is clicked
    function selectEmployee(row) {
        //First, remove the highlight from any previously selected row
        document.querySelectorAll('tr.selected').forEach(r => r.classList.remove('selected'));

        //Then highlight the newly selected one
        row.classList.add('selected');
        selectedId = row.getAttribute('data-id'); //store that employee's ID

        //Grab the edit and delete buttons
        const editBtn = document.getElementById('editBtn');
        const deleteBtn = document.getElementById('deleteBtn');

        //Update links dynamically based on which employee was clicked
        editBtn.href = '/edit/' + selectedId;
        deleteBtn.href = '/delete/' + selectedId;

        //Enable both buttons once someone is selected
        editBtn.classList.remove('disabled');
        deleteBtn.classList.remove('disabled');
    }

    //This part runs after the whole page loads
    document.addEventListener("DOMContentLoaded", function() {
        const deleteBtn = document.getElementById("deleteBtn");

        //When user clicks the delete button
        deleteBtn.addEventListener("click", function(event) {
            // If no employee is selected, stop and show a warning
            if (!selectedId) {
                event.preventDefault();
                alert("Please select an employee to delete.");
                return;
            }

            //Otherwise, confirm before deleting
            if (!confirm("Are you sure you want to delete this employee?")) {
                event.preventDefault();
            }
        });
    });
</script>

<!-- Styling Section -->
<style>
    /* Highlight selected employee row ‚Äî makes it pop a little */
    tr.selected {
        background-color: #cfe2ff !important;
        font-weight: 600;
        border-left: 4px solid #0d6efd;
    }

    /* Add smooth animations to buttons */
    .btn {
        transition: background-color 0.2s ease, transform 0.2s ease;
    }

    /* Lift buttons slightly on hover */
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    /* Custom hover colors for different button types */
    .btn-success:hover { background-color: #157347 !important; }
    .btn-warning:hover { background-color: #e0a800 !important; }
    .btn-danger:hover  { background-color: #bb2d3b !important; }
    .btn-secondary:hover { background-color: #5c636a !important; }
    .btn-primary:hover { background-color: #0b5ed7 !important; }

    /* Slight push down effect when you actually click */
    .btn:active {
        transform: translateY(0);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    /* Load Employees button - custom green style */
    .load-btn {
        background-color: #198754 !important;
        border: none;
        border-radius: 8px;
        transition: background-color 0.2s ease, transform 0.2s ease;
    }

    .load-btn:hover {
        background-color: #157347 !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    /* Keep consistent behavior for other button types */
    .update-btn, .delete-btn {
        transition: background-color 0.2s ease, transform 0.2s ease;
    }

    .update-btn:hover {
        background-color: #e0a800 !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .delete-btn:hover {
        background-color: #bb2d3b !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    /* Even if button looks disabled, still allow hover effect */
    .btn.disabled,
    .btn:disabled {
        pointer-events: auto !important;
        opacity: 0.8;
    }

    /* Keep table header visible while scrolling */
    .table-container {
        max-height: 550px;
        overflow-y: auto;
    }

    .table thead th {
        position: sticky;
        top: 0;
        background-color: #e9ecef;
        z-index: 2;
    }

    /* Page and container background setup */
    body {
        background-color: #f8f9fa;
    }

    .container {
        background-color: rgba(255, 255, 255, 0.97);
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* Custom banner color to match logo */
    .custom-header {
        background-color: #2F8DBE !important;
    }
</style>

<!-- HTML Layout -->
<body class="bg-light">
<div class="container py-5">
    <div class="card shadow-lg">

        <!-- Top banner with title and logo -->
        <div class="card-header custom-header text-white d-flex justify-content-between align-items-center">
            <h2 class="mb-0">Employee Directory Management System</h2>
            <img src="/logoimage.png"
                 alt="Directory Icon"
                 style="height: 100px; margin-right: 10px; border-radius: 6px;">
        </div>

        <!-- Button toolbar for Add / Update / Delete / Load -->
        <div class="d-flex justify-content-end gap-2 p-3 bg-white border-bottom">
            <a th:href="@{/add}" class="btn btn-primary fw-bold">‚ûï Add Employee</a>
            <a id="editBtn" href="#" class="btn btn-warning fw-bold disabled update-btn">‚úèÔ∏è Update Employee</a>
            <a id="deleteBtn" href="#" class="btn btn-danger fw-bold disabled delete-btn">üóë Delete Employee</a>

            <!-- Upload button that reads from a .txt file -->
            <form th:action="@{/upload}" method="post" enctype="multipart/form-data" class="d-flex align-items-center gap-2">
                <label for="fileInput"
                       class="btn btn-success fw-bold text-white mb-0 d-flex align-items-center gap-2 load-btn">
                    <span style="color:#ff6f00; font-size:1.1em;">üìÅ</span>
                    <span>Load Employees</span>
                </label>
                <input id="fileInput" type="file" name="file" accept=".txt" class="d-none" onchange="this.form.submit()">
            </form>
        </div>

        <!-- Search bar area -->
        <form th:action="@{/search}" method="get" class="d-flex justify-content-end align-items-center gap-2 p-3 bg-white border-bottom">
            <input type="text" class="form-control" name="keyword"
                   style="width: 320px;"
                   placeholder="Search by ID, Last Name, or Department..." th:value="${keyword}">
            <button type="submit" class="btn text-white fw-bold" style="background-color:#808080;">üîç Search</button>
            <a th:href="@{/}" class="btn btn-outline-secondary fw-bold">‚Ü© Clear</a>
        </form>

        <!-- Employee table section -->
        <div class="card-body">
            <div class="table-container">
                <table class="table table-striped table-hover align-middle">
                    <thead class="table-secondary">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Department</th>
                        <th>Phone</th>
                        <th>Office Location</th>
                        <th>Hire Date</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Loop through all employees -->
                    <tr th:each="emp : ${employees}" th:attr="data-id=${emp.id}" onclick="selectEmployee(this)">
                        <td class="d-flex align-items-center gap-2">
                            <img src="/badge.png" alt="ID Badge" width="35" height="35" class="rounded shadow-sm border border-light">
                            <span th:text="${emp.id}" class="fw-bold text-secondary"></span>
                        </td>
                        <td th:text="${emp.firstName + ' ' + emp.lastName}"></td>
                        <td th:text="${emp.email}"></td>
                        <td th:text="${emp.department}"></td>
                        <td th:text="${emp.phone}"></td>
                        <td th:text="${emp.officeLocation}"></td>
                        <td th:text="${#temporals.format(emp.hireDate, 'MMM dd, yyyy')}"></td>
                        <td>
                                <span th:text="${emp.active ? 'Active' : 'Inactive'}"
                                      th:classappend="${emp.active} ? 'badge bg-success' : 'badge bg-danger'"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- When no employees exist -->
            <div th:if="${employees.size() == 0}" class="alert alert-info text-center mt-3">
                No employees found. Click <a th:href="@{/add}" class="fw-bold text-decoration-none">Add Employee</a> to create one.
            </div>
        </div>
    </div>
</div>
</body>
</html>