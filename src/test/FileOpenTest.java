import java.io.BufferedWriter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import static org.junit.jupiter.api.Assertions.*;

/**
 * Robert Yantin Jr.
 * CEN 3024 - Software Development I
 * October 20, 2025
 * FileOpenTest.java
 *
 * This class tests the system's ability to work with text files.
 * It creates a temporary file, writes data to it, and then reads it back
 * to confirm that file creation, writing, and reading all works correctly.
 *
 * This helps verify that the Employee Directory can
 * handle simple file input and output operations with success.
 */

class FileOpenTest {

    //This test checks if a text file can be created, written to, read from, and deleted.
    //Basically, it's making sure the system can handle files before we start using them for real data.
    @org.junit.jupiter.api.Test
    void textFile_canBeCreatedAndOpened() throws IOException {
        //Create a temporary text file (it's automatically deleted later
        Path tmpfl = Files.createTempFile("employeestoadd-", ".txt");

        //The below are some fake employee records
        String line1 = "Ann,Watkins,ann.watkins@cityhall.com,Communications,6695,CM-230,2023-05-27";
        String line2 = "Josh,Henderson,josh.henderson@cityhall.com,Fire Dept,5278,FR-335,2022-09-12";

        //The below writes both lines in to the temporary file that was created
        try (BufferedWriter bw = Files.newBufferedWriter(tmpfl)) {
            bw.write(line1);
            bw.newLine();
            bw.write(line2);
        }

        //Make sure the file was actually crated and isn't empty
        assertTrue(Files.exists(tmpfl));
        assertTrue(Files.size(tmpfl) > 0);

        //Read the lines back from the file
        var lines = Files.readAllLines(tmpfl);

        //Make sure both lines are there and match exactly what we wrote
        assertEquals(2, lines.size());
        assertEquals(line1, lines.get(0));
        assertEquals(line2, lines.get(1));

        //Deletes the temporary file after the test
        Files.delete(tmpfl);
    }

    //Trying to read a file that doesn't exist should blow up (in this case it's okay)
    @org.junit.jupiter.api.Test
    void textFile_readNonExistent() throws IOException {
        var bogus = Path.of("This file does not exist");
        assertFalse(Files.exists(bogus), "File does not exist");

        //Trying to read a file that doesn't exist file should throw an IOEException
        assertThrows(java.io.IOException.class, () -> Files.readString(bogus));
    }
}